dockerfile: ./Dockerfile.dev
tags:
  - rtt/devel:latest
services:
  - mysql:
      from: mysql:5.7
      env:
        - MYSQL_ROOT_PASSWORD=rtt
        - MYSQL_DATABASE=rtt
        - MYSQL_USER=rtt
        - MYSQL_PASSWORD=rtt
      restart: always
env:
  - DB_TEST_ADDRESS=mysql
  - MAVEN_CONFIG=/tmp/maven/.m2
  - MAVEN_OPTS=-Duser.home=/tmp/maven

before: mkdir -p /tmp/maven/.m2 && mvn dependency:resolve -q

user: 1000:1000

tasks:
  env: env | sort
  test: mvn test
  shell: /bin/bash
  doc:
    disable: '*'
    cmd: mvn javadoc:javadoc
  jar:
    disable: '*'
    cmd: mvn package -DskipTests=true -Dmaven.javadoc.skip=true
